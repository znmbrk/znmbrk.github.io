---
import Layout from '../../layouts/Layout.astro';
---

<Layout title="Animating Maths - Projects - Zain Mobarik">
  <h1>Animating Maths</h1>
  <p class="author">JavaScript animations showcasing mathematical beauty</p>

  <h2>Project Explanation</h2>

  <p>Mathematics has a profound order and simplicity to it. My aim is to illustrate the beauty of this seemingly daunting subject in a way that highlights how awe-inspiring it can be.</p>

  <p>I produce my animations using JavaScript's p5.js Library. This is a library for creative coding, with a focus on making coding accessible and inclusive for artists and designers! p5.js has a full set of drawing functionality which I have utilised.</p>

  <h2>Project 1: Fourier Series!</h2>

  <p>A Fourier series is a sum that represents a periodic function as a sum of sine and cosine waves.</p>

  <div id="fourier" style="text-align: center; margin: 20px 0; padding: 20px; border: 1px solid #ccc; overflow-x: auto; max-width: 100%;"></div>

  <p><strong>Interactive Controls:</strong></p>
  <ul>
    <li>Use the first slider to control the number of circles (epicycles)</li>
    <li>Use the second slider to control the animation speed</li>
    <li>Watch how more circles create a more accurate square wave approximation</li>
  </ul>

  <hr>

  <p><a href="/projects">‚Üê Back to projects</a></p>

  <script src="https://cdnjs.cloudflare.com/ajax/libs/p5.js/1.4.1/p5.js"></script>
  <script is:inline>
    let time = 0;
    let wave = [];
    let numCirc;
    let speed;
    let col = 0;

    function setup() {
        // Make canvas responsive
        let containerWidth = document.getElementById('fourier').offsetWidth;
        let canvasWidth = Math.min(800, containerWidth - 40); // 40px for padding
        let canvasHeight = Math.min(400, canvasWidth * 0.5); // Maintain aspect ratio

        let canvas = createCanvas(canvasWidth, canvasHeight);
        numCirc = createSlider(1, 100, 1, 1);
        speed = createSlider(0.01, 3, 0.01, 0.01);
        canvas.parent("fourier");

        // Make sliders responsive too
        numCirc.style('width', Math.min(200, canvasWidth * 0.8) + 'px');
        speed.style('width', Math.min(200, canvasWidth * 0.8) + 'px');

        // Add labels for the sliders
        let label1 = createP('Number of Circles:');
        label1.parent("fourier");
        label1.style('margin', '10px 0 5px 0');
        numCirc.parent("fourier");

        let label2 = createP('Animation Speed:');
        label2.parent("fourier");
        label2.style('margin', '10px 0 5px 0');
        speed.parent("fourier");
    }

    function draw() {
        background(0);

        // Make positions responsive to canvas size
        let centerX = width * 0.3; // 30% from left
        let centerY = height * 0.5; // Center vertically
        let waveX = width * 0.65; // Wave starts at 65% from left

        translate(centerX, centerY);

        let x = 0;
        let y = 0;
        for (let i = 0; i < numCirc.value(); i++) {
            col = random(255);

            let prevX = x;
            let prevY = y;
            let n = i * 2 + 1;

            // Scale radius based on canvas size
            let baseRadius = Math.min(width, height) * 0.08; // 8% of smaller dimension
            let radius = baseRadius * (4 / (n * PI));
            x += radius * cos(n * time);
            y += radius * sin(n * time);

            stroke(255, 150);
            noFill();
            ellipse(prevX, prevY, radius * 2);

            stroke(200, col, 200);
            line(prevX, prevY, x, y);
        }

        wave.unshift(y);
        let waveStartX = waveX - centerX;
        translate(waveStartX, 0);
        line(x - waveStartX, y, 0, wave[0]);

        beginShape();
        noFill();
        stroke(255);
        let maxWaveLength = Math.min(150, width * 0.3); // Limit wave length based on screen size
        for (let i = 0; i < Math.min(wave.length, maxWaveLength); i++) {
            vertex(i, wave[i]);
        }
        endShape();

        if (wave.length > maxWaveLength) {
            wave.pop();
        }

        time += speed.value();
    }
  </script>
</Layout>